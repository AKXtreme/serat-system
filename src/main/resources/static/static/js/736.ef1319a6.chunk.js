"use strict";(self.webpackChunkserat_frontend=self.webpackChunkserat_frontend||[]).push([[736],{736:(e,i,t)=>{t.r(i),t.d(i,{default:()=>L});var n=t(5043),a=t(5206),o=t(9073),r=t(1645),s=t(691),l=t(3427),c=t(5444),d=t(2019),u=t(2751),f=t(647),h=t(7419),g=t(6497),m=t(6051),x=t(1005),y=t(8918),A=t(6399),j=t(6851),p=t(1966),C=t(9330),w=t(7407),k=t(6191),b=t(5337),I=t(617),v=t(8143),T=t(4524),V=t(4733),S=t(9621),z=t(579);const{Search:B}=c.A,{Option:E}=g.A,{TabPane:F}=y.A,L=()=>{const[e,i]=(0,n.useState)([]),[t,L]=(0,n.useState)(!1),[N,K]=(0,n.useState)(!1),[$,q]=(0,n.useState)(!1),[Y,R]=(0,n.useState)("add"),[U,D]=(0,n.useState)(null),[H,O]=(0,n.useState)(""),[P,_]=(0,n.useState)("all"),[M]=l.A.useForm();(0,n.useEffect)(()=>{J()},[]);const J=async()=>{L(!0);try{const e=await S.mq.getConfigs();200===e.data.code&&i(e.data.rows||[])}catch(e){d.Ay.error("Failed to fetch system configurations")}finally{L(!1)}},Q=e=>{R("edit"),D(e),M.setFieldsValue({...e}),K(!0)},W={name:"file",action:"/api/system/config/importData",headers:{authorization:`Bearer ${localStorage.getItem("token")}`},onChange(e){"done"===e.file.status?(d.Ay.success(`${e.file.name} file uploaded successfully`),J()):"error"===e.file.status&&d.Ay.error(`${e.file.name} file upload failed.`)}},Z=e=>"Y"===e?"Built-in":"Custom",G=e=>"Y"===e?"blue":"green",X=e.filter(e=>{const i=!H||e.configName.toLowerCase().includes(H.toLowerCase())||e.configKey.toLowerCase().includes(H.toLowerCase())||e.configValue.toLowerCase().includes(H.toLowerCase()),t="all"===P||"builtin"===P&&"Y"===e.configType||"custom"===P&&"N"===e.configType;return i&&t}),ee=[{title:"Config ID",dataIndex:"configId",key:"configId",width:100},{title:"Config Name",dataIndex:"configName",key:"configName",render:e=>(0,z.jsxs)(m.A,{children:[(0,z.jsx)(T.A,{style:{color:"#1890ff"}}),e]})},{title:"Config Key",dataIndex:"configKey",key:"configKey",render:e=>(0,z.jsx)(A.A,{color:"cyan",children:e})},{title:"Config Value",dataIndex:"configValue",key:"configValue",ellipsis:!0,width:200,render:e=>(0,z.jsx)("div",{style:{maxWidth:180,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e})},{title:"Type",dataIndex:"configType",key:"configType",render:e=>(0,z.jsx)(A.A,{color:G(e),children:Z(e)})},{title:"Create Time",dataIndex:"createTime",key:"createTime",width:180},{title:"Update Time",dataIndex:"updateTime",key:"updateTime",width:180},{title:"Actions",key:"actions",width:200,render:(e,i)=>(0,z.jsxs)(m.A,{size:"small",children:[(0,z.jsx)(a.Ay,{type:"link",icon:(0,z.jsx)(k.A,{}),onClick:()=>(e=>{D(e),q(!0)})(i),size:"small",children:"View"}),(0,z.jsx)(a.Ay,{type:"link",icon:(0,z.jsx)(w.A,{}),onClick:()=>Q(i),size:"small",children:"Edit"}),"Y"!==i.configType&&(0,z.jsx)(f.A,{title:"Delete Configuration",description:"Are you sure you want to delete this configuration?",onConfirm:()=>(async e=>{try{const i=await S.mq.deleteConfig(e);200===i.data.code?(d.Ay.success("Configuration deleted successfully"),J()):d.Ay.error(i.data.msg||"Failed to delete configuration")}catch(i){d.Ay.error("Failed to delete configuration")}})(i.configId),okText:"Yes",cancelText:"No",children:(0,z.jsx)(a.Ay,{type:"link",danger:!0,icon:(0,z.jsx)(p.A,{}),size:"small",children:"Delete"})})]})}];return(0,z.jsxs)("div",{children:[(0,z.jsx)(o.A,{title:"System Configuration",style:{marginBottom:16},children:(0,z.jsxs)(h.A,{gutter:[16,16],justify:"space-between",align:"middle",children:[(0,z.jsx)(r.A,{span:8,children:(0,z.jsx)(B,{placeholder:"Search configurations",value:H,onChange:e=>O(e.target.value),style:{width:"100%"}})}),(0,z.jsx)(r.A,{children:(0,z.jsxs)(m.A,{children:[(0,z.jsx)(a.Ay,{type:"primary",icon:(0,z.jsx)(b.A,{}),onClick:()=>{R("add"),D(null),M.resetFields(),M.setFieldsValue({configType:"Y"}),K(!0)},children:"Add Configuration"}),(0,z.jsx)(a.Ay,{icon:(0,z.jsx)(v.A,{}),onClick:async()=>{try{const e=await S.mq.refreshConfigCache();200===e.data.code?d.Ay.success("Configuration cache refreshed successfully"):d.Ay.error(e.data.msg||"Failed to refresh cache")}catch(e){d.Ay.error("Failed to refresh cache")}},children:"Refresh Cache"}),(0,z.jsx)(a.Ay,{icon:(0,z.jsx)(C.A,{}),onClick:async()=>{try{const e=await S.mq.exportConfigs(),i=window.URL.createObjectURL(new Blob([e.data])),t=document.createElement("a");t.href=i,t.setAttribute("download","system_config.xlsx"),document.body.appendChild(t),t.click(),t.remove(),d.Ay.success("Export successful")}catch(e){d.Ay.error("Export failed")}},children:"Export"}),(0,z.jsx)(j.A,{...W,showUploadList:!1,children:(0,z.jsx)(a.Ay,{icon:(0,z.jsx)(V.A,{}),children:"Import"})}),(0,z.jsx)(a.Ay,{icon:(0,z.jsx)(I.A,{}),onClick:J,children:"Refresh"})]})})]})}),(0,z.jsxs)(o.A,{children:[(0,z.jsxs)(y.A,{activeKey:P,onChange:_,style:{marginBottom:16},children:[(0,z.jsx)(F,{tab:"All Configurations"},"all"),(0,z.jsx)(F,{tab:"Built-in Configurations"},"builtin"),(0,z.jsx)(F,{tab:"Custom Configurations"},"custom")]}),(0,z.jsx)(x.A,{columns:ee,dataSource:X,rowKey:"configId",loading:t,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,i)=>`${i[0]}-${i[1]} of ${e} items`}})]}),(0,z.jsx)(u.A,{title:"add"===Y?"Add Configuration":"Edit Configuration",visible:N,onOk:async()=>{try{const e={...await M.validateFields(),configId:"edit"===Y?U.configId:void 0};let i;i="add"===Y?await S.mq.createConfig(e):await S.mq.updateConfig(e),200===i.data.code?(d.Ay.success(`Configuration ${"add"===Y?"created":"updated"} successfully`),K(!1),J()):d.Ay.error(i.data.msg||`Failed to ${Y} configuration`)}catch(e){d.Ay.error(`Failed to ${Y} configuration`)}},onCancel:()=>K(!1),width:700,okText:"add"===Y?"Create":"Update",children:(0,z.jsxs)(l.A,{form:M,layout:"vertical",initialValues:{configType:"Y"},children:[(0,z.jsxs)(h.A,{gutter:16,children:[(0,z.jsx)(r.A,{span:12,children:(0,z.jsx)(l.A.Item,{name:"configName",label:"Configuration Name",rules:[{required:!0,message:"Please input configuration name!"},{min:2,max:100,message:"Configuration name must be 2-100 characters!"}],children:(0,z.jsx)(c.A,{placeholder:"Enter configuration name"})})}),(0,z.jsx)(r.A,{span:12,children:(0,z.jsx)(l.A.Item,{name:"configKey",label:"Configuration Key",rules:[{required:!0,message:"Please input configuration key!"},{min:2,max:100,message:"Configuration key must be 2-100 characters!"},{pattern:/^[a-zA-Z0-9._-]+$/,message:"Configuration key can only contain letters, numbers, dots, hyphens, and underscores!"}],children:(0,z.jsx)(c.A,{placeholder:"Enter configuration key"})})})]}),(0,z.jsx)(h.A,{gutter:16,children:(0,z.jsx)(r.A,{span:24,children:(0,z.jsx)(l.A.Item,{name:"configValue",label:"Configuration Value",rules:[{required:!0,message:"Please input configuration value!"},{max:500,message:"Configuration value cannot exceed 500 characters!"}],children:(0,z.jsx)(c.A.TextArea,{rows:4,placeholder:"Enter configuration value"})})})}),(0,z.jsx)(h.A,{gutter:16,children:(0,z.jsx)(r.A,{span:24,children:(0,z.jsx)(l.A.Item,{name:"configType",label:"Configuration Type",children:(0,z.jsxs)(g.A,{disabled:"edit"===Y&&"Y"===(null===U||void 0===U?void 0:U.configType),children:[(0,z.jsx)(E,{value:"Y",children:"Built-in"}),(0,z.jsx)(E,{value:"N",children:"Custom"})]})})})}),(0,z.jsx)(h.A,{gutter:16,children:(0,z.jsx)(r.A,{span:24,children:(0,z.jsx)(l.A.Item,{name:"remark",label:"Remark",children:(0,z.jsx)(c.A.TextArea,{rows:3,placeholder:"Enter remark (optional)",maxLength:500})})})})]})}),(0,z.jsx)(u.A,{title:"Configuration Details",visible:$,onCancel:()=>q(!1),footer:[(0,z.jsx)(a.Ay,{onClick:()=>q(!1),children:"Close"},"close"),(0,z.jsx)(a.Ay,{type:"primary",onClick:()=>{q(!1),Q(U)},children:"Edit"},"edit")],width:700,children:U&&(0,z.jsxs)(s.A,{bordered:!0,column:1,children:[(0,z.jsx)(s.A.Item,{label:"Configuration ID",children:U.configId}),(0,z.jsx)(s.A.Item,{label:"Configuration Name",children:U.configName}),(0,z.jsx)(s.A.Item,{label:"Configuration Key",children:(0,z.jsx)(A.A,{color:"cyan",children:U.configKey})}),(0,z.jsx)(s.A.Item,{label:"Configuration Value",children:(0,z.jsx)("div",{style:{maxHeight:200,overflow:"auto",padding:"8px",background:"#f5f5f5",borderRadius:"4px",wordBreak:"break-all"},children:U.configValue})}),(0,z.jsx)(s.A.Item,{label:"Configuration Type",children:(0,z.jsx)(A.A,{color:G(U.configType),children:Z(U.configType)})}),(0,z.jsx)(s.A.Item,{label:"Create Time",children:U.createTime}),(0,z.jsx)(s.A.Item,{label:"Update Time",children:U.updateTime||"-"}),(0,z.jsx)(s.A.Item,{label:"Create By",children:U.createBy||"-"}),(0,z.jsx)(s.A.Item,{label:"Update By",children:U.updateBy||"-"}),(0,z.jsx)(s.A.Item,{label:"Remark",children:U.remark||"-"})]})})]})}},8143:(e,i,t)=>{t.d(i,{A:()=>l});var n=t(8168),a=t(5043);const o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};var r=t(2172),s=function(e,i){return a.createElement(r.A,(0,n.A)({},e,{ref:i,icon:o}))};const l=a.forwardRef(s)}}]);
//# sourceMappingURL=736.ef1319a6.chunk.js.map