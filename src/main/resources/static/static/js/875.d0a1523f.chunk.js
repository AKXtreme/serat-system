"use strict";(self.webpackChunkserat_frontend=self.webpackChunkserat_frontend||[]).push([[875],{875:(e,s,r)=>{r.r(s),r.d(s,{default:()=>I});var a=r(5043),l=r(5964),n=r(5206),t=r(9073),i=r(1645),d=r(691),c=r(3427),o=r(5444),m=r(2019),u=r(2751),h=r(7419),A=r(6497),p=r(6051),x=r(6851),j=r(8617),w=r(8143),y=r(4733),g=r(3722),f=r(8729),b=r(9621),P=r(579);const{Option:v}=A.A,I=()=>{var e;const{user:s,updateUser:r}=(0,f.A)(),[I,F]=(0,a.useState)(!1),[k,C]=(0,a.useState)(!1),[N,E]=(0,a.useState)(!1),[z]=c.A.useForm(),[q]=c.A.useForm();(0,a.useEffect)(()=>{s&&z.setFieldsValue({userName:s.userName,nickName:s.nickName,email:s.email,phonenumber:s.phonenumber,sex:s.sex})},[s,z]);return s?(0,P.jsxs)("div",{children:[(0,P.jsx)(t.A,{title:"User Profile",style:{marginBottom:24},children:(0,P.jsxs)(h.A,{gutter:24,children:[(0,P.jsx)(i.A,{span:8,children:(0,P.jsxs)(t.A,{size:"small",style:{textAlign:"center"},children:[(0,P.jsx)(l.A,{size:120,src:s.avatar,icon:(0,P.jsx)(g.A,{}),style:{marginBottom:16}}),(0,P.jsx)("br",{}),(0,P.jsx)(x.A,{showUploadList:!1,beforeUpload:e=>{if(!("image/jpeg"===e.type||"image/png"===e.type))return m.Ay.error("You can only upload JPG/PNG file!"),!1;return!!(e.size/1024/1024<2)||(m.Ay.error("Image must smaller than 2MB!"),!1)},customRequest:e=>{let{file:s}=e;return(async e=>{C(!0);const s=new FormData;s.append("avatarfile",e);try{const e=await b.mq.uploadAvatar(s);200===e.data.code?(m.Ay.success("Avatar updated successfully"),await r()):m.Ay.error(e.data.msg||"Failed to upload avatar")}catch(a){m.Ay.error("Failed to upload avatar")}finally{C(!1)}return!1})(s)},children:(0,P.jsx)(n.Ay,{icon:(0,P.jsx)(y.A,{}),loading:k,children:"Change Avatar"})})]})}),(0,P.jsx)(i.A,{span:16,children:(0,P.jsx)(t.A,{size:"small",title:"Basic Information",children:(0,P.jsxs)(d.A,{column:2,bordered:!0,children:[(0,P.jsx)(d.A.Item,{label:"User ID",children:s.userId}),(0,P.jsx)(d.A.Item,{label:"Username",children:s.userName}),(0,P.jsx)(d.A.Item,{label:"Nickname",children:s.nickName}),(0,P.jsx)(d.A.Item,{label:"Department",children:(null===(e=s.dept)||void 0===e?void 0:e.deptName)||"-"}),(0,P.jsx)(d.A.Item,{label:"Email",children:s.email||"-"}),(0,P.jsx)(d.A.Item,{label:"Phone",children:s.phonenumber||"-"}),(0,P.jsx)(d.A.Item,{label:"Gender",children:"0"===s.sex?"Male":"1"===s.sex?"Female":"Unknown"}),(0,P.jsx)(d.A.Item,{label:"Create Time",children:s.createTime}),(0,P.jsx)(d.A.Item,{label:"Last Login Time",span:2,children:s.loginDate||"-"})]})})})]})}),(0,P.jsx)(t.A,{title:"Edit Profile",children:(0,P.jsxs)(c.A,{form:z,layout:"vertical",onFinish:async e=>{F(!0);try{const s=await b.mq.updateProfile(e);200===s.data.code?(m.Ay.success("Profile updated successfully"),await r()):m.Ay.error(s.data.msg||"Failed to update profile")}catch(s){m.Ay.error("Failed to update profile")}finally{F(!1)}},children:[(0,P.jsxs)(h.A,{gutter:16,children:[(0,P.jsx)(i.A,{span:12,children:(0,P.jsx)(c.A.Item,{name:"nickName",label:"Nickname",rules:[{required:!0,message:"Please input your nickname!"},{min:2,max:30,message:"Nickname must be 2-30 characters!"}],children:(0,P.jsx)(o.A,{placeholder:"Enter your nickname"})})}),(0,P.jsx)(i.A,{span:12,children:(0,P.jsx)(c.A.Item,{name:"email",label:"Email",rules:[{type:"email",message:"Please enter a valid email!"}],children:(0,P.jsx)(o.A,{placeholder:"Enter your email"})})})]}),(0,P.jsxs)(h.A,{gutter:16,children:[(0,P.jsx)(i.A,{span:12,children:(0,P.jsx)(c.A.Item,{name:"phonenumber",label:"Phone Number",rules:[{pattern:/^1[3-9]\d{9}$/,message:"Please enter a valid phone number!"}],children:(0,P.jsx)(o.A,{placeholder:"Enter your phone number"})})}),(0,P.jsx)(i.A,{span:12,children:(0,P.jsx)(c.A.Item,{name:"sex",label:"Gender",children:(0,P.jsxs)(A.A,{placeholder:"Select gender",children:[(0,P.jsx)(v,{value:"0",children:"Male"}),(0,P.jsx)(v,{value:"1",children:"Female"}),(0,P.jsx)(v,{value:"2",children:"Unknown"})]})})})]}),(0,P.jsx)(c.A.Item,{children:(0,P.jsxs)(p.A,{children:[(0,P.jsx)(n.Ay,{type:"primary",htmlType:"submit",loading:I,icon:(0,P.jsx)(w.A,{}),children:"Save Changes"}),(0,P.jsx)(n.Ay,{icon:(0,P.jsx)(j.A,{}),onClick:()=>E(!0),children:"Change Password"})]})})]})}),(0,P.jsx)(u.A,{title:"Change Password",visible:N,onCancel:()=>{E(!1),q.resetFields()},footer:null,width:500,children:(0,P.jsxs)(c.A,{form:q,layout:"vertical",onFinish:async e=>{try{const s=await b.mq.updatePassword(e);200===s.data.code?(m.Ay.success("Password changed successfully"),E(!1),q.resetFields()):m.Ay.error(s.data.msg||"Failed to change password")}catch(s){m.Ay.error("Failed to change password")}},children:[(0,P.jsx)(c.A.Item,{name:"oldPassword",label:"Current Password",rules:[{required:!0,message:"Please input your current password!"}],children:(0,P.jsx)(o.A.Password,{placeholder:"Enter current password"})}),(0,P.jsx)(c.A.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please input your new password!"},{min:6,max:20,message:"Password must be 6-20 characters!"}],children:(0,P.jsx)(o.A.Password,{placeholder:"Enter new password"})}),(0,P.jsx)(c.A.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password!"},e=>{let{getFieldValue:s}=e;return{validator:(e,r)=>r&&s("newPassword")!==r?Promise.reject(new Error("The two passwords do not match!")):Promise.resolve()}}],children:(0,P.jsx)(o.A.Password,{placeholder:"Confirm new password"})}),(0,P.jsx)(c.A.Item,{children:(0,P.jsxs)(p.A,{children:[(0,P.jsx)(n.Ay,{type:"primary",htmlType:"submit",children:"Change Password"}),(0,P.jsx)(n.Ay,{onClick:()=>{E(!1),q.resetFields()},children:"Cancel"})]})})]})})]}):(0,P.jsx)("div",{children:"Loading..."})}},8143:(e,s,r)=>{r.d(s,{A:()=>d});var a=r(8168),l=r(5043);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};var t=r(2172),i=function(e,s){return l.createElement(t.A,(0,a.A)({},e,{ref:s,icon:n}))};const d=l.forwardRef(i)}}]);
//# sourceMappingURL=875.d0a1523f.chunk.js.map