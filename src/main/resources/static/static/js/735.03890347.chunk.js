"use strict";(self.webpackChunkserat_frontend=self.webpackChunkserat_frontend||[]).push([[735],{5735:(e,t,s)=>{s.r(t),s.d(t,{default:()=>E});var i=s(5043),o=s(5206),a=s(9073),r=s(1645),n=s(3427),l=s(5444),d=s(1118),c=s(2019),p=s(2751),h=s(647),u=s(7419),m=s(6497),x=s(6051),A=s(1005),y=s(6399),j=s(6851),w=s(1966),g=s(9330),f=s(7407),k=s(5337),C=s(617),P=s(4733),S=s(3722),I=s(9621),b=s(579);const{Search:F}=l.A,{Option:v}=m.A,E=()=>{const[e,t]=(0,i.useState)([]),[s,E]=(0,i.useState)(!1),[$,q]=(0,i.useState)(!1),[D,N]=(0,i.useState)("add"),[T,L]=(0,i.useState)(null),[z,R]=(0,i.useState)(""),[O]=n.A.useForm();(0,i.useEffect)(()=>{B()},[]);const B=async()=>{E(!0);try{const e=await I.mq.getPositions();200===e.data.code&&t(e.data.rows||[])}catch(e){c.Ay.error("Failed to fetch positions")}finally{E(!1)}},U={name:"file",action:"/api/system/post/importData",headers:{authorization:`Bearer ${localStorage.getItem("token")}`},onChange(e){"done"===e.file.status?(c.Ay.success(`${e.file.name} file uploaded successfully`),B()):"error"===e.file.status&&c.Ay.error(`${e.file.name} file upload failed.`)}},V=e.filter(e=>!z||(e.postName.toLowerCase().includes(z.toLowerCase())||e.postCode.toLowerCase().includes(z.toLowerCase()))),_=[{title:"Position ID",dataIndex:"postId",key:"postId",width:100},{title:"Position Code",dataIndex:"postCode",key:"postCode",render:e=>(0,b.jsx)(y.A,{color:"blue",children:e})},{title:"Position Name",dataIndex:"postName",key:"postName",render:e=>(0,b.jsxs)(x.A,{children:[(0,b.jsx)(S.A,{style:{color:"#1890ff"}}),e]})},{title:"Display Order",dataIndex:"postSort",key:"postSort",width:120,sorter:(e,t)=>e.postSort-t.postSort},{title:"Status",dataIndex:"status",key:"status",render:e=>(0,b.jsx)(y.A,{color:"0"===e?"green":"red",children:"0"===e?"Normal":"Disabled"})},{title:"Create Time",dataIndex:"createTime",key:"createTime",width:180},{title:"Remark",dataIndex:"remark",key:"remark",ellipsis:!0,render:e=>e||"-"},{title:"Actions",key:"actions",width:200,render:(e,t)=>(0,b.jsxs)(x.A,{size:"small",children:[(0,b.jsx)(o.Ay,{type:"link",icon:(0,b.jsx)(f.A,{}),onClick:()=>(e=>{N("edit"),L(e),O.setFieldsValue({...e}),q(!0)})(t),children:"Edit"}),(0,b.jsx)(h.A,{title:"Delete Position",description:"Are you sure you want to delete this position?",onConfirm:()=>(async e=>{try{const t=await I.mq.deletePosition(e);200===t.data.code?(c.Ay.success("Position deleted successfully"),B()):c.Ay.error(t.data.msg||"Failed to delete position")}catch(t){c.Ay.error("Failed to delete position")}})(t.postId),okText:"Yes",cancelText:"No",children:(0,b.jsx)(o.Ay,{type:"link",danger:!0,icon:(0,b.jsx)(w.A,{}),children:"Delete"})})]})}],[K,J]=(0,i.useState)([]),M={selectedRowKeys:K,onChange:J};return(0,b.jsxs)("div",{children:[(0,b.jsxs)(a.A,{title:"Position Management",style:{marginBottom:16},children:[(0,b.jsxs)(u.A,{gutter:[16,16],justify:"space-between",align:"middle",children:[(0,b.jsx)(r.A,{span:8,children:(0,b.jsx)(F,{placeholder:"Search positions",value:z,onChange:e=>R(e.target.value),style:{width:"100%"}})}),(0,b.jsx)(r.A,{children:(0,b.jsxs)(x.A,{children:[(0,b.jsx)(o.Ay,{type:"primary",icon:(0,b.jsx)(k.A,{}),onClick:()=>{N("add"),L(null),O.resetFields(),O.setFieldsValue({status:"0",postSort:0}),q(!0)},children:"Add Position"}),(0,b.jsx)(o.Ay,{icon:(0,b.jsx)(g.A,{}),onClick:async()=>{try{const e=await I.mq.exportPositions(),t=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.href=t,s.setAttribute("download","positions.xlsx"),document.body.appendChild(s),s.click(),s.remove(),c.Ay.success("Export successful")}catch(e){c.Ay.error("Export failed")}},children:"Export"}),(0,b.jsx)(j.A,{...U,showUploadList:!1,children:(0,b.jsx)(o.Ay,{icon:(0,b.jsx)(P.A,{}),children:"Import"})}),(0,b.jsx)(o.Ay,{icon:(0,b.jsx)(C.A,{}),onClick:B,children:"Refresh"})]})})]}),K.length>0&&(0,b.jsx)(u.A,{style:{marginTop:16},children:(0,b.jsx)(r.A,{children:(0,b.jsxs)(x.A,{children:[(0,b.jsxs)("span",{children:["Selected ",K.length," items"]}),(0,b.jsx)(o.Ay,{type:"primary",danger:!0,size:"small",onClick:()=>(async e=>{try{const t=await I.mq.deletePositions(e);200===t.data.code?(c.Ay.success("Positions deleted successfully"),B()):c.Ay.error(t.data.msg||"Failed to delete positions")}catch(t){c.Ay.error("Failed to delete positions")}})(K),children:"Batch Delete"}),(0,b.jsx)(o.Ay,{size:"small",onClick:()=>J([]),children:"Clear Selection"})]})})})]}),(0,b.jsx)(a.A,{children:(0,b.jsx)(A.A,{columns:_,dataSource:V,rowKey:"postId",loading:s,rowSelection:M,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} items`}})}),(0,b.jsx)(p.A,{title:"add"===D?"Add Position":"Edit Position",visible:$,onOk:async()=>{try{const e={...await O.validateFields(),postId:"edit"===D?T.postId:void 0};let t;t="add"===D?await I.mq.createPosition(e):await I.mq.updatePosition(e),200===t.data.code?(c.Ay.success(`Position ${"add"===D?"created":"updated"} successfully`),q(!1),B()):c.Ay.error(t.data.msg||`Failed to ${D} position`)}catch(e){c.Ay.error(`Failed to ${D} position`)}},onCancel:()=>q(!1),width:600,okText:"add"===D?"Create":"Update",children:(0,b.jsxs)(n.A,{form:O,layout:"vertical",initialValues:{status:"0",postSort:0},children:[(0,b.jsxs)(u.A,{gutter:16,children:[(0,b.jsx)(r.A,{span:12,children:(0,b.jsx)(n.A.Item,{name:"postName",label:"Position Name",rules:[{required:!0,message:"Please input position name!"},{min:2,max:50,message:"Position name must be 2-50 characters!"}],children:(0,b.jsx)(l.A,{placeholder:"Enter position name"})})}),(0,b.jsx)(r.A,{span:12,children:(0,b.jsx)(n.A.Item,{name:"postCode",label:"Position Code",rules:[{required:!0,message:"Please input position code!"},{min:2,max:64,message:"Position code must be 2-64 characters!"},{pattern:/^[a-zA-Z0-9_]+$/,message:"Position code can only contain letters, numbers, and underscores!"}],children:(0,b.jsx)(l.A,{placeholder:"Enter position code"})})})]}),(0,b.jsxs)(u.A,{gutter:16,children:[(0,b.jsx)(r.A,{span:12,children:(0,b.jsx)(n.A.Item,{name:"postSort",label:"Display Order",rules:[{required:!0,message:"Please input display order!"}],children:(0,b.jsx)(d.A,{min:0,max:9999,placeholder:"Enter display order",style:{width:"100%"}})})}),(0,b.jsx)(r.A,{span:12,children:(0,b.jsx)(n.A.Item,{name:"status",label:"Status",children:(0,b.jsxs)(m.A,{children:[(0,b.jsx)(v,{value:"0",children:"Normal"}),(0,b.jsx)(v,{value:"1",children:"Disabled"})]})})})]}),(0,b.jsx)(u.A,{gutter:16,children:(0,b.jsx)(r.A,{span:24,children:(0,b.jsx)(n.A.Item,{name:"remark",label:"Remark",children:(0,b.jsx)(l.A.TextArea,{rows:4,placeholder:"Enter remark (optional)",maxLength:500})})})})]})})]})}}}]);
//# sourceMappingURL=735.03890347.chunk.js.map